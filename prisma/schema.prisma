// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

// Repository model that stores GitHub repo metadata
model Repository {
  id            String     @id @default(cuid())
  owner         String     
  name          String     
  defaultBranch String     @default("main")
  url           String
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  analyses      Analysis[] 

  @@unique([owner, name])
  @@index([owner, name])
}

// Analysis model that  stores health check results
model Analysis {
  id               String     @id @default(cuid())
  repositoryId     String
  repository       Repository @relation(fields: [repositoryId], references: [id], onDelete: Cascade)
  
  overallScore     Int
  activityScore    Int
  communityScore   Int
  maintenanceScore Int
  
  analysisData     Json
  createdAt        DateTime   @default(now())

  @@index([repositoryId])
  @@index([createdAt])
}

// Contributor model
model Contributor {
  id                 String   @id @default(cuid())
  username           String   @unique
  avatarUrl          String?  
  totalContributions Int      @default(0)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}